<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Bayesian meta-analysis on ivermectin | Bayesian meta-analysis of ivermectin as a treatment for COVID-19</title>
  <meta name="description" content="Bookdown for Bayesian meta-analysis" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Bayesian meta-analysis on ivermectin | Bayesian meta-analysis of ivermectin as a treatment for COVID-19" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Bookdown for Bayesian meta-analysis" />
  <meta name="github-repo" content="saverymax/bayesian-meta-analysis-bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Bayesian meta-analysis on ivermectin | Bayesian meta-analysis of ivermectin as a treatment for COVID-19" />
  
  <meta name="twitter:description" content="Bookdown for Bayesian meta-analysis" />
  

<meta name="author" content="Max Savery" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="bayesian-methods-for-meta-analysis.html"/>
<link rel="next" href="appendix.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian meta-analysis on the effect of ivermectin as a treatment for COVID-19</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Technical preface</a></li>
<li class="chapter" data-level="2" data-path="bayesian-methods-for-meta-analysis.html"><a href="bayesian-methods-for-meta-analysis.html"><i class="fa fa-check"></i><b>2</b> Bayesian methods for Meta-analysis</a><ul>
<li class="chapter" data-level="2.1" data-path="bayesian-methods-for-meta-analysis.html"><a href="bayesian-methods-for-meta-analysis.html#why-bayesian"><i class="fa fa-check"></i><b>2.1</b> Why Bayesian?</a></li>
<li class="chapter" data-level="2.2" data-path="bayesian-methods-for-meta-analysis.html"><a href="bayesian-methods-for-meta-analysis.html#informative-priors"><i class="fa fa-check"></i><b>2.2</b> Informative priors</a></li>
<li class="chapter" data-level="2.3" data-path="bayesian-methods-for-meta-analysis.html"><a href="bayesian-methods-for-meta-analysis.html#weakly-informative-priors"><i class="fa fa-check"></i><b>2.3</b> Weakly informative priors</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bayesian-meta-analysis-on-ivermectin.html"><a href="bayesian-meta-analysis-on-ivermectin.html"><i class="fa fa-check"></i><b>3</b> Bayesian meta-analysis on ivermectin</a><ul>
<li class="chapter" data-level="3.1" data-path="bayesian-meta-analysis-on-ivermectin.html"><a href="bayesian-meta-analysis-on-ivermectin.html#sensitivity-analysis"><i class="fa fa-check"></i><b>3.1</b> Sensitivity analysis</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i><b>4</b> Appendix</a><ul>
<li class="chapter" data-level="4.1" data-path="appendix.html"><a href="appendix.html#posteriors"><i class="fa fa-check"></i><b>4.1</b> Posterior estimates</a></li>
<li class="chapter" data-level="4.2" data-path="appendix.html"><a href="appendix.html#tau-posteriors"><i class="fa fa-check"></i><b>4.2</b> Tau posteriors</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/saverymax/bayesian-meta-analysis-bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian meta-analysis of ivermectin as a treatment for COVID-19</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayesian-meta-analysis-on-ivermectin" class="section level1 hasAnchor">
<h1><span class="header-section-number">3</span> Bayesian meta-analysis on ivermectin<a href="bayesian-meta-analysis-on-ivermectin.html#bayesian-meta-analysis-on-ivermectin" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Having discussed Bayesian methods for estimating random effects models in meta-analyses, with a particular focus on the use of weakly informative priors, we are now prepared to conduct a Bayesian meta-analysis of our own. The data this meta-analysis we use was reconstructed by <span class="citation">Gelman (<a href="#ref-Gelman-blog" role="doc-biblioref">2022</a>)</span> in a blog post. This post discusses the effect of the anti-parasitic medication ivermectin. It should be noted that there is little evidence that ivermectin is an effective treatment for COVID-19, and studies around this area have been rife with pseudoscience and suspiscious data. The purpose of the blog post was to further discuss how one might draw false positive results in a meta-analysis, with a bayesian treatment of studies related to ivermectin, and so we extend that here.</p>
<p>This data used in this analysis is on the log scale (log of the odds ratio), so that we can exponentiate the cofficients from our Bayesian model to get the relative risk (RR). The RR is the multiplicative factor by which the mean of individuals in group <span class="math inline">\(x_i\)</span> is equal to <span class="math inline">\(\exp(B_i)\)</span> times the mean of individuals in the reference group, keeping all other covariates
equal. For a RR of 50%, we say that the treatment resulted in a 50% improvement relative to the control. In the case of the results presented here, we say that patients treated with ivermectin had a <span class="math inline">\(p\)</span>% improvement, depending on the outcome measured in the studies.</p>
<p>We first fit a random-effects model on the data using Stan, and then conduct a sensitivity analysis. The Stan models, including their priors, can be found in Section <a href="#sec:stan"><strong>??</strong></a> of the appendix.</p>
<div id="sensitivity-analysis" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.1</span> Sensitivity analysis<a href="bayesian-meta-analysis-on-ivermectin.html#sensitivity-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Having introduced the topic of our meta-analysis and the means by which we will conduct it, we now proceed to discuss the extent to which the posterior estimates and intervals change when the priors on the between-study variance are altered. In Bayesian data analysis, this is known as a prior sensitivity analysis. The intent of our sensitivity analysis is to determine the effect that altering the weak prior has on our posterior estimates and conclusions of the meta-analysis. As described above, we use the inverse-gamma, the half-t distribution, and the half-cauchy, roughly following the work <span class="citation">Williams, Rast, and Bürkner (<a href="#ref-Williams-2018" role="doc-biblioref">2018</a>)</span>. For reference, we also include a uniform prior, though this is not recommended due to the improper posteriors that can result from its use <span class="citation">(Gelman <a href="#ref-Gelman-2006" role="doc-biblioref">2006</a>)</span>.</p>
<p>We use the following priors with the hyperparameters shown in Equation <a href="#eq:priors">(<strong>??</strong>)</a>, following <span class="citation">Williams, Rast, and Bürkner (<a href="#ref-Williams-2018" role="doc-biblioref">2018</a>)</span>. The prior densities are shown in Figure <a href="bayesian-meta-analysis-on-ivermectin.html#fig:prior-den">3.1</a>. We also include a uniform prior of U<span class="math inline">\((0,10)\)</span> to demonstrate the effect of an unrealistic prior. It is unreasonable to assume that the between-study variance is distributed uniformly from 0 all the way to 10, 10 being quite large in this context.</p>
<p><span class="math display">\[\begin{equation}
\label{eq:priors}
\begin{gathered}
\tau \sim \text{U}(0, 10) \\
\tau \sim \text{Inverse-gamma}(1,0.15)\\
\tau \sim \text{Half-t}(0, 0.5) \\
\tau \sim \text{Half-cauchy}(0, 0.5)
\end{gathered}
\end{equation}\]</span></p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:prior-den"></span>
<img src="bayesian-meta-analysis_files/figure-html/prior-den-1.png" alt="Prior densities used in sensitivity analysis" width="70%" />
<p class="caption">
Figure 3.1: Prior densities used in sensitivity analysis
</p>
</div>
<p>The posterior estimates on the log of the odds scale can be found in Section <a href="appendix.html#posteriors">4.1</a> of the appendix. For brevity, we do not discuss them here. However, Figure <a href="bayesian-meta-analysis-on-ivermectin.html#fig:post-dens">3.2</a> does show the posterior density plots of these parameters. Posterior plots were generated with the R package bayesplot <span class="citation">(Gabry et al. <a href="#ref-Gabry-2019" role="doc-biblioref">2019</a>)</span>. Important to note is that the parameters estimated with the uniform prior have the largest tails, whereas those from the model using the half-t have smaller tails. This is to be expected. The half-t imposes more constraints than the uniform or the half-cauchy. Despite the theoretical recommendations against the inverse-gamma, in this case the corresponding posteriors are relatively similar to those of the half-t or half-cauchy.</p>
<div class="figure"><span style="display:block;" id="fig:post-dens"></span>
<img src="bayesian-meta-analysis_files/figure-html/post-dens-1.png" alt="Posterior densities of parameters estimated from random effects model, log-odds scale" width="50%" /><img src="bayesian-meta-analysis_files/figure-html/post-dens-2.png" alt="Posterior densities of parameters estimated from random effects model, log-odds scale" width="50%" /><img src="bayesian-meta-analysis_files/figure-html/post-dens-3.png" alt="Posterior densities of parameters estimated from random effects model, log-odds scale" width="50%" /><img src="bayesian-meta-analysis_files/figure-html/post-dens-4.png" alt="Posterior densities of parameters estimated from random effects model, log-odds scale" width="50%" />
<p class="caption">
Figure 3.2: Posterior densities of parameters estimated from random effects model, log-odds scale
</p>
</div>
<p>Notice the <span class="math inline">\(\theta_{\text{new}}\)</span> parameter in Figure <a href="bayesian-meta-analysis-on-ivermectin.html#fig:post-dens">3.2</a>. This is a simulated estimate of the effect of ivermectin for some hypothetical future study, where the effect is drawn from <span class="math inline">\(N(\mu,\tau)\)</span> and the specific values of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\tau\)</span> are sampled from their respective posteriors. This takes into account the uncertainty associated with the parameters and the sampling uncertainty of conducting a new study. It means that, given all the uncertainty associated with different types of studies included in the meta-analysis, if we were to conduct a new study on the effect of ivermectin as a treatment for COVID-19, the distribution of <span class="math inline">\(\theta_{\text{new}}\)</span> will approximate the future effects that could be found in new studies. Figure <a href="bayesian-meta-analysis-on-ivermectin.html#fig:tau-post-dens">3.3</a> shows the posteriors for the between study deviation. We can see that the uniform prior allows for the widest distribution of <span class="math inline">\(\tau\)</span>, whereas the half-t allows for the smallest.</p>
<div class="figure"><span style="display:block;" id="fig:tau-post-dens"></span>
<img src="bayesian-meta-analysis_files/figure-html/tau-post-dens-1.png" alt="Posterior densities of tau" width="50%" /><img src="bayesian-meta-analysis_files/figure-html/tau-post-dens-2.png" alt="Posterior densities of tau" width="50%" /><img src="bayesian-meta-analysis_files/figure-html/tau-post-dens-3.png" alt="Posterior densities of tau" width="50%" /><img src="bayesian-meta-analysis_files/figure-html/tau-post-dens-4.png" alt="Posterior densities of tau" width="50%" />
<p class="caption">
Figure 3.3: Posterior densities of tau
</p>
</div>
<p>We can then proceed to discuss the changes in the RR ratio. Table <a href="#tab:rr"><strong>??</strong></a> shows the RR estimates of <span class="math inline">\(\mu\)</span> and - <span class="math inline">\(\theta_{\text{new}}\)</span> for all different priors. We can see that the mean estimates themselves do not change in large amounts, which makes sense given that the only difference between the models presented here is the prior on the between-study variance. So while we don’t expect the point estimates to change, the credible intervals for these point estimates will. For example, we can see that the interval for <span class="math inline">\(\mu\)</span> goes from <span class="math inline">\((0.2703, 0.9669)\)</span> when using the uniform prior on <span class="math inline">\(\tau\)</span> to <span class="math inline">\((0.3192, 0.8303)\)</span> and <span class="math inline">\((0.3342, 0.7796)\)</span> for the half-cauchy and half-t priors, respectively. Even more interesting, the interval for <span class="math inline">\(\theta_{\text{new}}\)</span> goes from <span class="math inline">\((0.1872, 1.3982)\)</span> when using the half-cauchy prior to <span class="math inline">\((0.2755, 0.9794)\)</span> when using the half-t. This is indicative of the extent to which our meta-analysis conclusions can change based on the prior; in the half-cauchy case we would say that a future effect could result in a positive or negative change in outcome for ivermectin treatment, but when using the half-t we would conclude that ivermectin has either a negligible effect to a large positive effect. But in either case, the intervals are very wide.</p>
<p>It is also important to mention that while the average RR of <span class="math inline">\(\mu\)</span> is less than 1 in all models, <span class="math inline">\(\theta_{\text{new}}\)</span> takes quite a larger range, including values larger than 1 in the 90% credible interval. In general, from this set of studies included in the meta-analysis, such a result makes it difficult to draw conclusions about ivermectin one way or the other. It may be that these studies are too heterogeneous to find conclusive evidence. This will be discussed further in the conclusion.</p>

<p>Figure <a href="bayesian-meta-analysis-on-ivermectin.html#fig:intervals">3.4</a> shows the credible intervals for the study-specific effects <span class="math inline">\(\theta_i\)</span>, <span class="math inline">\(\mu\)</span>, and <span class="math inline">\(\theta_{\text{new}}\)</span>. This nicely illustrates the effect of our prior sensitivity analysis: The intervals for the uniform prior are really large compared to all other priors. While the intervals of the study-specific effects when using the inverse gamma and half-cauchy priors often include 1, the more informative half-t limits the spread of these intervals. Therefore, the conclusions of the meta-analysis need to be qualified based on this sensitivity analysis. At this point, it becomes less a statistical question and more one for the biomedical domain. Which of these studies has methodological errors, or are there other factors causing the observed effects to vary considerably and be quite sensitive to choice of prior? This question was discussed considerably in the medical literature and in social media; thus it is here we choose to conclude our prior sensitivity analysis.</p>
<div class="figure"><span style="display:block;" id="fig:intervals"></span>
<img src="bayesian-meta-analysis_files/figure-html/intervals-1.png" alt="Equal tail credible intervals, for RR of posterior estimates" width="50%" /><img src="bayesian-meta-analysis_files/figure-html/intervals-2.png" alt="Equal tail credible intervals, for RR of posterior estimates" width="50%" /><img src="bayesian-meta-analysis_files/figure-html/intervals-3.png" alt="Equal tail credible intervals, for RR of posterior estimates" width="50%" /><img src="bayesian-meta-analysis_files/figure-html/intervals-4.png" alt="Equal tail credible intervals, for RR of posterior estimates" width="50%" />
<p class="caption">
Figure 3.4: Equal tail credible intervals, for RR of posterior estimates
</p>
</div>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-Gabry-2019">
<p>Gabry, Jonah, Daniel Simpson, Aki Vehtari, Michael Betancourt, and Andrew Gelman. 2019. “Visualization in Bayesian Workflow.” <em>J. R. Stat. Soc. A</em> 182 (2): 389–402. <a href="https://doi.org/10.1111/rssa.12378">https://doi.org/10.1111/rssa.12378</a>.</p>
</div>
<div id="ref-Gelman-2006">
<p>Gelman, Andrew. 2006. “Prior distributions for variance parameters in hierarchical models (comment on article by Browne and Draper).” <em>Bayesian Analysis</em> 1 (3): 515–34. <a href="https://doi.org/10.1214/06-BA117A">https://doi.org/10.1214/06-BA117A</a>.</p>
</div>
<div id="ref-Gelman-blog">
<p>Gelman, Andrew. 2022. “Exploring Some Questions About Meta-Analysis (Using Ivermectin as an Example), with R and Stan Code.” <a href="https://statmodeling.stat.columbia.edu/2022/02/28/answering-some-questions-about-meta-analysis-using-ivermectin-as-an-example/">https://statmodeling.stat.columbia.edu/2022/02/28/answering-some-questions-about-meta-analysis-using-ivermectin-as-an-example/</a>.</p>
</div>
<div id="ref-Williams-2018">
<p>Williams, Donald R, Philippe Rast, and Paul - Christian Bürkner. 2018. “Bayesian Meta-Analysis with Weakly Informative Prior Distributions.” PsyArXiv. <a href="https://doi.org/10.31234/osf.io/7tbrm">https://doi.org/10.31234/osf.io/7tbrm</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="bayesian-methods-for-meta-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="appendix.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/saverymax/sem-political-trust/edit/main/meta_analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bayesian-meta-analysis.pdf", "bayesian-meta-analysis.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
