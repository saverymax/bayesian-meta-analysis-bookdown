<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Bayesian methods for Meta-analysis | Bayesian meta-analysis of ivermectin as a treatment for COVID-19</title>
  <meta name="description" content="Bookdown for Bayesian meta-analysis" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Bayesian methods for Meta-analysis | Bayesian meta-analysis of ivermectin as a treatment for COVID-19" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Bookdown for Bayesian meta-analysis" />
  <meta name="github-repo" content="saverymax/bayesian-meta-analysis-bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Bayesian methods for Meta-analysis | Bayesian meta-analysis of ivermectin as a treatment for COVID-19" />
  
  <meta name="twitter:description" content="Bookdown for Bayesian meta-analysis" />
  

<meta name="author" content="Max Savery" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="bayesian-meta-analysis-on-ivermectin.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian meta-analysis on the effect of ivermectin as a treatment for COVID-19</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Technical preface</a></li>
<li class="chapter" data-level="2" data-path="bayesian-methods-for-meta-analysis.html"><a href="bayesian-methods-for-meta-analysis.html"><i class="fa fa-check"></i><b>2</b> Bayesian methods for Meta-analysis</a><ul>
<li class="chapter" data-level="2.1" data-path="bayesian-methods-for-meta-analysis.html"><a href="bayesian-methods-for-meta-analysis.html#why-bayesian"><i class="fa fa-check"></i><b>2.1</b> Why Bayesian?</a></li>
<li class="chapter" data-level="2.2" data-path="bayesian-methods-for-meta-analysis.html"><a href="bayesian-methods-for-meta-analysis.html#informative-priors"><i class="fa fa-check"></i><b>2.2</b> Informative priors</a></li>
<li class="chapter" data-level="2.3" data-path="bayesian-methods-for-meta-analysis.html"><a href="bayesian-methods-for-meta-analysis.html#weakly-informative-priors"><i class="fa fa-check"></i><b>2.3</b> Weakly informative priors</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="bayesian-meta-analysis-on-ivermectin.html"><a href="bayesian-meta-analysis-on-ivermectin.html"><i class="fa fa-check"></i><b>3</b> Bayesian meta-analysis on ivermectin</a><ul>
<li class="chapter" data-level="3.1" data-path="bayesian-meta-analysis-on-ivermectin.html"><a href="bayesian-meta-analysis-on-ivermectin.html#sensitivity-analysis"><i class="fa fa-check"></i><b>3.1</b> Sensitivity analysis</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/saverymax/sem-political-trust" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian meta-analysis of ivermectin as a treatment for COVID-19</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bayesian-methods-for-meta-analysis" class="section level1 hasAnchor">
<h1><span class="header-section-number">2</span> Bayesian methods for Meta-analysis<a href="bayesian-methods-for-meta-analysis.html#bayesian-methods-for-meta-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="why-bayesian" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.1</span> Why Bayesian?<a href="bayesian-methods-for-meta-analysis.html#why-bayesian" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Fixed effect models for meta-analysis are suitable when the studies are homogeneous and can be assumed to share an overall effect. However, as described in , fixed effect models fail when the overall effect is heterogenous between studies. It is then necessary to turn to random effect models so as to be able to estimate study-specific effects. However, to fully take advantage of these models, such as for the purpose of generating posteriors and uncertainty intervals around the study-specific effects or to incorporate prior information, Bayesian methods are required. Bayesian methods allow us to combine a likelihood based on observed data and a prior distribution model which incorporates previous beliefs and historical information. In the prior, we can incorporate information from previous studies, our beliefs about the size of the effect we are studying, or use the prior to make a conservative estimate . In this way, using a Bayesian approach we can expand the random effects model to more carefully consider the observed effects from any given meta-analysis.</p>
<p>Furthermore, the use of Bayesian methods lends itself to cases in which the sample size is relatively small. When we underestimate the between-study variance, we produce over-confident estimates, in that our confidence intervals are too small . Furthermore, Bayesian estimation methods avoid estimates between-study variance that approach 0, which, in the Maximum Likelihood or Restriced Maximum Likelihood context, is not uncommon when estimating random-effects models with small sample sizes . Given the advantages of the random effects model in the Bayesian framework, as opposed to the fixed effects model, we now proceed to describe Bayesian inference in the context of meta-analysis and random effects models.</p>

<p>Here we provide a brief introduction to Bayesian methods in general and then describe their use in conducting meta analyses.</p>
<p>In the Bayesian framework, the likelihood of observed data is combined with a prior distribution that represents historical information. This is commonly written as
<span class="math display">\[\begin{gather}
\label{eq:bayes}
p(\theta|y) \propto p(y|\theta)p(\theta)
\end{gather}\]</span>
where <span class="math inline">\(\theta\)</span> represents a vector of the parameters in our model and <span class="math inline">\(y\)</span> the vector of observations . This distribution is referred to as the posterior density. <span class="math inline">\(\propto\)</span> represents the proportionality due to the normalizing constant which makes the posterior a proper density.</p>
<p>To generate samples from this posterior distribution, various sampling techniques can be used. Due to the background required to explain these methods and the focus of this report on meta-analysis, the sampling techniques are not discussed in detail here. However, because we will conduct a meta-analysis using the Bayesian modelling software Stan , it is worth mentioning the sampler used there: the No-U-Turn Sampler (NUTS) is used , an improvement on the Hamiltonian Monte Carlo method.</p>
<p>Following , we now describe the hierarchical model used for conducting a random effects Bayesian meta-analysis. In this formulation, each study will have a particular mean and variance</p>
<p><span class="math display">\[\begin{gather}
y_i \sim N(\theta_i, \sigma_i^2) \\
\theta_i \sim N(\mu, \tau^2) \\
(\mu, \tau^2) \sim prior(.)
\end{gather}\]</span></p>
<p>where <span class="math inline">\(y_i\)</span> is the effect we observe in each study <span class="math inline">\(i=1,...,N\)</span>, <span class="math inline">\(\theta_i\)</span> is the mean effect within the context of study <span class="math inline">\(i\)</span>, <span class="math inline">\(\sigma_i^2\)</span> is the variance within that study, <span class="math inline">\(\mu\)</span> is the mean effect of the studies, and <span class="math inline">\(\tau^2\)</span> is the between-study variance. The effect for a given study <span class="math inline">\(i\)</span> is drawn from <span class="math inline">\(N(\mu, \tau^2)\)</span>, as opposed to being fixed (as in the fixed effect model). Notice that the effect from each study, <span class="math inline">\(\theta_i\)</span>, shares a distribution <span class="math inline">\(N(\mu, \tau^2)\)</span> with all other studies .</p>
<p>Using Equation , the joint posterior density of the random effects model will be
<span class="math display">\[\begin{gather}
p(\theta, \mu, \tau^2|y) \propto p(y|\theta, \mu, \tau^2)p(\theta, \mu, \tau^2) = \prod_{i=1}^{k}p(y_i|\theta_i,\sigma_i^2)p(\theta_i|\mu,\tau^2)p(\mu, \tau^2)
\end{gather}\]</span></p>
We then must consider which priors to use for <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\tau^2\)</span>. This is a fairly important question.  discuss a case in which the choice of a uniform prior leads to completely incorrect posterior estimates and therefore misleading conclusions of a study. They state

<p>This implies that in the small-sample world of meta-analysis, the prior is going to have a disproportionate effect.</p>
<p>The priors for the parameters in our model can be chosen with various justifications. We discuss two “camps” of priors: those that are informative and those that are ostensibly less informative–which we will refer to as weakly informative. We will briefly discuss informative priors and then spend the rest of this review discussing and applying weakly informative priors.</p>
</div>
<div id="informative-priors" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.2</span> Informative priors<a href="bayesian-methods-for-meta-analysis.html#informative-priors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>An informative prior can be considered one which is based on results from previous studies. For example, both  and  generate predictive distributions from previous Cochrane reviews of meta-analyses. These predictive distributions can be used as informative priors for conducting new meta-analyses. In , the informative priors are created for a variety of different types of binary-outcome studies, such as diseas outcome or infection onset. The priors are informative in that they use estimates generated from modelling the meta-analysis data as the parameters in the priors.</p>
<p> also generate predictive distributions from previous meta-analyses using Cochrane reviews. In contrast to , they focus on priors for continuous outcomes. They conduct a prior sensitivity analysis, demonstrating how the use of informative priors can dramatically change the between-study variance estimate, either increasing or reducing <span class="math inline">\(\tau^2\)</span> depending on the context.</p>
<p>Taking a a different approach,  consider how to generate informative priors using data-augmentation techniques. Specifically, they generate new data from inverse-gamma distributions based on previous studies, and add this generated data to the observed data. This approach actually stands in contrast to the fully Bayesian approach we have discussed so far, in that they are not actually using a prior for parameters in their model but are instead augmenting the observed data with previous data. This is a philosophically similar but mathematically different technique.</p>
</div>
<div id="weakly-informative-priors" class="section level2 hasAnchor">
<h2><span class="header-section-number">2.3</span> Weakly informative priors<a href="bayesian-methods-for-meta-analysis.html#weakly-informative-priors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As mentioned, the choice of prior is a fairly important decision, but also a somewhat contentious one. The reason for this is that the choice brings together arguments from statistical theory, philosophy, and domain-specific expertise. There are certain statistical properties that must be considered in the choice of the prior, namely conjugacy and impropriety of the posterior. But these mathematical properties don’t dilute the real-world phenomenon that we are modelling, and thus philosophical arguments regarding what type of information the prior provides and expert opinion regarding the relevance of the information provided by the prior must always be taken into account.</p>
<p>Weakly informative priors are those that do not consider information from previous studies but still constrain the estimates of the parameters to a realistic or meaningful range of values. They often have desirable mathematical properties as well. That is to say, all priors come with their own set of assumptions, so that there is no such thing as a non-informative prior, but it is possible to select priors that contribute less information than others .</p>
<p>We will discuss three weakly informative priors previously used for Baysesian meta-analysis: inverse-gamma, half-t, and half-cauchy distributions. Following this discussion, we will apply these priors in our own prior sensitivity analysis.</p>
<p>The inverse-gamma prior for <span class="math inline">\(\tau^2\)</span> can be written as</p>
<p><span class="math display">\[\begin{gather}
    p(\tau^2) = \frac{\beta^{\alpha}}{\Gamma(\alpha)}(\tau^2)^{-(\alpha+1)}\exp\Bigg(\frac{\beta}{\tau^2}\Bigg)
\end{gather}\]</span></p>
<p>It is often used as a weakly informative prior due to the fact that it is conjugate for <span class="math inline">\(\tau^2\)</span> in the random effects model. However, the posterior is sensitive to the value of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> when <span class="math inline">\(\tau^2\)</span> is small . This means that the inverse-gamma is not strictly weakly informative, as it incorporates information based on ones choice of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. A weakly informative prior should be invariant to this sort of hyperparameter selection. Relatedly,  argue that the inverse-gamma distribution pulls <span class="math inline">\(\tau^2\)</span> values away from 0, which nullifies its weakly informative properties in the case where <span class="math inline">\(\tau^2\)</span> is small.</p>
<p>We next consider the half-t prior. The half-t distribution is a special case of the folded-t distribution where the <span class="math inline">\(\mu\)</span> parameter (not shown) is equal to 0 .  make the case for the use of this prior as a replacement to the inverse-gamma, in order to avoid the issues with inverse-gamma when <span class="math inline">\(\tau^2\)</span> is small. The half-t is defined as</p>
<p><span class="math display">\[\begin{gather}
\label{eq:half-t}
    p(\tau) \propto \Bigg(1 + \frac{1}{\nu}\Big(\frac{\tau}{2}\Big)^2\Bigg)^{-(\nu+1)/2}
\end{gather}\]</span></p>
<p>The half-cauchy distribution is a special case of the half-t distribution (and therefore the folded-t), where <span class="math inline">\(\nu=1\)</span> in Equation . More exactly, it is defined as
<span class="math display">\[\begin{gather}
    p(\tau) = \frac{(\tau)^{-1/2}(1+\tau^2)^{-1}}{\beta(1/2,1/2)}
\end{gather}\]</span></p>
<p>where <span class="math inline">\(\beta\)</span> refers to the Beta function. It can allow for wider tails than the half-t, meaning that in the case of random effect models, it allows for larger estimates of the between-study variance .</p>
We have presented three weakly informative prior distributions that can realistically constrain the between-study variance, while also maintaining some semblance of mathematical justification in the context of the likelihoods used in Bayesian meta-analysis; this does not, however, shake the sense of the somewhat arbitrary nature of these choices. To this–abeit regarding only the half-cauchy– say,

<p>Generalizing from this, each prior occupies the space of compromise between any staunch set of assumptions regarding the appropriate parameter values. Beyond that, one must apply such priors to their own meta-analysis of interest, and determine if, yes, indeed, these priors lead to reasonable results. That is, then, the next step that we take.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="bayesian-meta-analysis-on-ivermectin.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/saverymax/sem-political-trust/edit/main/bayesian_review.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bayesian-meta-analysis.pdf", "bayesian-meta-analysis.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
